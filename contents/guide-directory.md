# 아키텍처 및 Directory 스타일 가이드

<br/><br/>



## :speech_balloon: 개요

해당 프로젝트에서 사용된 아키텍처 및 Directory 구조에 대해 설명합니다.

<br/><br/>


## 아키텍처

마이크로 서비스 내부 구조를 정의할 때 반드시 **내부 구조의 다양성** 을 고려해야 합니다.  
자율적인 마이크로 서비스 팀에 의한 `폴리그랏한 내부 구조`를 가질 수 있기 때문입니다.  

<br/>

마이크로 서비스 아키텍처에서 각 서비스는 각기 목표와 활용도에 따라 명확하게 분리돼야 하고,  
각 서비스 목적에 따라 적절한 개발 언어 및 저장소, 내부 아키텍처를 정의하는 것이 바람직합니다.

> 조회나 아주 간단한 기능의 경우 헥사고날이나 클린 아키텍처 방식의 구조를 고수할 필요는 없을 것입니다.  
> 그렇지만 비즈니스 규칙이 복잡할 경우 헥사고날이나 클린 아키텍처 구조 기반으로 정의하는 것이 바람직할 것입니다.

<br/>

해당 프로젝트는 복잡한 비즈니스 규칙과 다양한 조회 및 명령 기능을 포함하며,  
다양한 인터페이스(Repository, Event-message, API call proxy 등) 적용이 필요하므로  
`헥사고날 아키텍처`를 지향한 구조를 사용하여 서비스 내부 구조를 유연하고 기민하게 적용하겠습니다.  

|<img src="https://github.com/cholnh/spring-best-practice-todo/blob/main/assets/images/guide-directory/ddd-hex-arch-1.png" width="800"/>|
|-|
|헥사고날 아키텍처의 포트와 어댑터|

<br/>

헥사고날 아키텍처 구조는 다음과 같습니다.

- 고수준의 비즈니스 로직을 표현하는 내부 영역 
    + 순수한 비즈니스 로직을 표현하는 기술 독립적인 영역
    + 외부 영역과 연결되는 포트를 가지고 있음
- 인터페이스 처리를 담당하는 저수준의 외부 영역
    + 외부 요청을 처리하는 인바운드 어댑터
    + 비즈니스 로직에 의해 호출되어 외부와 연계되는 아웃바운드 어댑터

<br/>

헥사고날 아키텍처 포트의 특징은 다음과 같습니다.
- 고수준의 내부 영역이 외부의 구체 어댑터에 전혀 의존하지 않습니다. (포트에 의해)
- 인바운드 포트는 내부 영역 사용을 위해 표출된 API 입니다.
- 아웃바운드 포트는 외부를 호출하는 방법을 정의합니다.
- 아웃바운드 포트가 외부의 아웃바운드 어댑터를 호출해서 외부 시스템과 연계하는 것이 아니라  
    아웃바운드 어댑터가 아웃바운드 포트에 의존해서 구현됩니다. (DIP 원칙)

<br/>

헥사고날 아키텍처 어댑터의 특징은 다음과 같습니다.
- 인바운드 어댑터의 종류 예시
    + REST API 컨트롤러
    + 웹 페이지 스프링 MVC 컨트롤러
    + 커맨드 핸들러
    + 이벤트 메시지 구독 핸들러 등
- 아웃바운드 어댑터 종류 예시
    + DAO (Jpa, MySQL, NoSQL 등등)
    + 이벤트 메시지 발행 클래스
    + 외부 서비스 호출 프록시 등

<br/>

전체적인 내부 구조의 모양은 다음과 같습니다.

|<img src="https://github.com/cholnh/spring-best-practice-todo/blob/main/assets/images/guide-directory/ddd-hex-domain-2.png" width="900"/>|
|-|
|마이크로 서비스의 내부 구조|

<br/>

